---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  C:\Users\jrk5012/Documents/GitHub/ncaa_rosters/code/clean/clean.log
  log type:  text
 opened on:  18 Oct 2018, 18:50:32

. 
. run ${code}/ancillary_data/state_abbrevs.do

. cd ${code}
C:\Users\jrk5012\Documents\GitHub\ncaa_rosters\code\clean

. run _clean_functions.do

. 
. // cleans raw roster data
. 
. ******************************************************************************
. // build local with schools and make schools dataset
. import excel using ${homedir}/notes/schools.xlsx, clear firstrow

. drop if missing(scrape_date)
(0 observations deleted)

. gen dset = subinstr(filename, ".py", "", 1)

. local schools ""

. local N = _N

. forvalues i = 1/`N' {
  2.         local x = dset[`i']
  3.         local schools = "`schools' `x'"
  4. }

. 
. // make school summary dataset
. rename school   school_full_name

. rename dset     school

. assert table + ul + grid == 1

. gen scrape_type = "table" if table==1
(56 missing values generated)

. replace scrape_type = "ul" if ul==1
(52 real changes made)

. replace scrape_type = "grid" if grid==1
(4 real changes made)

. local keepvars school school_full_name conference scrape_date football_url scrape_type

. keep  `keepvars'

. order `keepvars'

. 
. // school lists by scrape type
. foreach stype in table ul grid {
  2.         local schools_`stype' = ""
  3.         forvalues i = 1/`N' {
  4.                 local is_`stype' = scrape_type[`i'] == "`stype'"
  5.                 if `is_`stype'' {
  6.                         local x = school[`i']
  7.                         local schools_`stype'= "`schools_`stype'' `x'"
  8.                 }
  9.         }
 10.         disp "`schools_`stype''"
 11. }
 arkansas clemson florida_state georgia_tech illinois nc_state northwestern ohio_state oklahoma_state
 alabama arizona arizona_state auburn baylor boston_college cal colorado florida georgia indiana iowa iowa_state kansas kansas_state kentucky louisville maryland miami michigan michig
> an_state minnesota miss_state missouri notre_dame ole_miss oregon oregon_state penn_state pitt purdue rutgers south_carolina stanford syracuse tcu tennessee texas texas_am texas_tec
> h ucla north_carolina usc utah vanderbilt virginia virginia_tech wake_forest washington washington_state west_virginia wisconsin
 duke lsu nebraska oklahoma

. 
. 
. la var school                           "College"

. la var school_full_name         "Full College Name"

. la var conference                       "Conference"

. la var scrape_date                      "Date rosters scraped"

. la var football_url             "URL of football roster"

. 
. rename school college

. rename school_full_name college_full_name

. 
. export delimited using ${outdata}/schools.csv, replace
file C:\Users\jrk5012/Documents/GitHub/ncaa_rosters/output/cleaned/schools.csv saved

. save ${outdata}/schools, replace
file ~/Documents/GitHub/ncaa_rosters/output/cleaned/schools.dta saved

. 
. ******************************************************************************
. // loop through schools and combine by scrape type
. 
. foreach grp in table ul grid {
  2.         clear
  3.         tempfile `grp's
  4.         local i = 0
  5.         foreach school in `schools_`grp'' {
  6.                 import delimited using ${indata}/`school'_rosters.csv, clear varnames(1)
  7.                 cap drop v1
  8. 
.                 if `i'>0 {
  9.                         append using ``grp's'
 10.                 }
 11.                 save ``grp's', replace
 12. 
.                 local ++i
 13. 
.         }
 14. }
(11 vars, 433 obs)
(note: file C:\Users\jrk5012\AppData\Local\Temp\ST_459c_000001.tmp not found)
file C:\Users\jrk5012\AppData\Local\Temp\ST_459c_000001.tmp saved
(11 vars, 344 obs)
(note: variable highschool was str3, now str73 to accommodate using data's values)
(note: variable school was str3, now str73 to accommodate using data's values)
(note: variable highschooltext was str3, now str36 to accommodate using data's values)
(note: variable schooltext was str3, now str36 to accommodate using data's values)
(note: variable sport was str17, now str20 to accommodate using data's values)
(note: variable college was str7, now str8 to accommodate using data's values)
file C:\Users\jrk5012\AppData\Local\Temp\ST_459c_000001.tmp saved
(11 vars, 557 obs)
(note: variable name was str23, now str30 to accommodate using data's values)
(note: variable hometown was str35, now str40 to accommodate using data's values)
(note: variable highschool was str36, now str73 to accommodate using data's values)
(note: variable school was str36, now str73 to accommodate using data's values)
(note: variable highschooltext was str11, now str36 to accommodate using data's values)
(note: variable schooltext was str11, now str36 to accommodate using data's values)
file C:\Users\jrk5012\AppData\Local\Temp\ST_459c_000001.tmp saved
(11 vars, 391 obs)
(note: variable name was str21, now str30 to accommodate using data's values)
(note: variable hometown was str25, now str40 to accommodate using data's values)
(note: variable highschool was str3, now str73 to accommodate using data's values)
(note: variable school was str49, now str73 to accommodate using data's values)
(note: variable highschooltext was str3, now str36 to accommodate using data's values)
(note: variable schooltext was str11, now str36 to accommodate using data's values)
(note: variable sport was str20, now str23 to accommodate using data's values)
(note: variable college was str12, now str13 to accommodate using data's values)
file C:\Users\jrk5012\AppData\Local\Temp\ST_459c_000001.tmp saved
(11 vars, 517 obs)
(note: variable highschool was str49, now str73 to accommodate using data's values)
(note: variable school was str57, now str73 to accommodate using data's values)
(note: variable highschooltext was str29, now str36 to accommodate using data's values)
(note: variable schooltext was str29, now str36 to accommodate using data's values)
(note: variable sport was str20, now str23 to accommodate using data's values)
(note: variable college was str8, now str13 to accommodate using data's values)
file C:\Users\jrk5012\AppData\Local\Temp\ST_459c_000001.tmp saved
(11 vars, 572 obs)
(note: variable name was str28, now str36 to accommodate using data's values)
(note: variable hometown was str54, now str57 to accommodate using data's values)
(note: variable highschool was str54, now str73 to accommodate using data's values)
(note: variable school was str54, now str73 to accommodate using data's values)
(note: variable highschooltext was str29, now str36 to accommodate using data's values)
(note: variable schooltext was str29, now str36 to accommodate using data's values)
(note: variable sport was str20, now str23 to accommodate using data's values)
(note: variable college was str8, now str13 to accommodate using data's values)
file C:\Users\jrk5012\AppData\Local\Temp\ST_459c_000001.tmp saved
(11 vars, 485 obs)
(note: variable name was str24, now str36 to accommodate using data's values)
(note: variable highschool was str60, now str73 to accommodate using data's values)
(note: variable school was str60, now str73 to accommodate using data's values)
(note: variable nametext was str4, now str9 to accommodate using data's values)
(note: variable hometowntext was str22, now str24 to accommodate using data's values)
(note: variable highschooltext was str22, now str36 to accommodate using data's values)
(note: variable schooltext was str22, now str36 to accommodate using data's values)
(note: variable sport was str20, now str23 to accommodate using data's values)
(note: variable college was str12, now str13 to accommodate using data's values)
file C:\Users\jrk5012\AppData\Local\Temp\ST_459c_000001.tmp saved
(11 vars, 866 obs)
(note: variable name was str23, now str36 to accommodate using data's values)
(note: variable hometown was str28, now str60 to accommodate using data's values)
(note: variable highschool was str32, now str73 to accommodate using data's values)
(note: variable school was str51, now str73 to accommodate using data's values)
(note: variable nametext was str4, now str9 to accommodate using data's values)
(note: variable hometowntext was str8, now str24 to accommodate using data's values)
(note: variable highschooltext was str11, now str36 to accommodate using data's values)
(note: variable schooltext was str16, now str36 to accommodate using data's values)
(note: variable college was str10, now str13 to accommodate using data's values)
file C:\Users\jrk5012\AppData\Local\Temp\ST_459c_000001.tmp saved
(11 vars, 464 obs)
(note: variable name was str26, now str36 to accommodate using data's values)
(note: variable hometowntext was str22, now str24 to accommodate using data's values)
(note: variable highschooltext was str22, now str36 to accommodate using data's values)
(note: variable schooltext was str22, now str36 to accommodate using data's values)
(note: variable sport was str17, now str23 to accommodate using data's values)
file C:\Users\jrk5012\AppData\Local\Temp\ST_459c_000001.tmp saved
(6 vars, 518 obs)
(note: file C:\Users\jrk5012\AppData\Local\Temp\ST_459c_000002.tmp not found)
file C:\Users\jrk5012\AppData\Local\Temp\ST_459c_000002.tmp saved
(6 vars, 441 obs)
(note: variable hometown was str36, now str83 to accommodate using data's values)
(note: variable highschool was str55, now str99 to accommodate using data's values)
file C:\Users\jrk5012\AppData\Local\Temp\ST_459c_000002.tmp saved
(6 vars, 603 obs)
(note: variable name was str25, now str26 to accommodate using data's values)
(note: variable hometown was str49, now str83 to accommodate using data's values)
(note: variable highschool was str47, now str99 to accommodate using data's values)
file C:\Users\jrk5012\AppData\Local\Temp\ST_459c_000002.tmp saved
(6 vars, 471 obs)
(note: variable name was str22, now str26 to accommodate using data's values)
(note: variable hometown was str44, now str83 to accommodate using data's values)
(note: variable highschool was str34, now str99 to accommodate using data's values)
(note: variable sport was str17, now str23 to accommodate using data's values)
(note: variable college was str6, now str13 to accommodate using data's values)
file C:\Users\jrk5012\AppData\Local\Temp\ST_459c_000002.tmp saved
(6 vars, 504 obs)
(note: variable name was str21, now str26 to accommodate using data's values)
(note: variable hometown was str37, now str83 to accommodate using data's values)
(note: variable highschool was str39, now str99 to accommodate using data's values)
(note: variable sport was str20, now str23 to accommodate using data's values)
(note: variable college was str6, now str13 to accommodate using data's values)
file C:\Users\jrk5012\AppData\Local\Temp\ST_459c_000002.tmp saved
(6 vars, 736 obs)
(note: variable name was str24, now str26 to accommodate using data's values)
(note: variable hometown was str34, now str83 to accommodate using data's values)
(note: variable highschool was str45, now str99 to accommodate using data's values)
(note: variable sport was str20, now str23 to accommodate using data's values)
file C:\Users\jrk5012\AppData\Local\Temp\ST_459c_000002.tmp saved
(6 vars, 814 obs)
(note: variable name was str25, now str26 to accommodate using data's values)
(note: variable hometown was str32, now str83 to accommodate using data's values)
(note: variable highschool was str63, now str99 to accommodate using data's values)
(note: variable college was str3, now str14 to accommodate using data's values)
file C:\Users\jrk5012\AppData\Local\Temp\ST_459c_000002.tmp saved
(6 vars, 382 obs)
(note: variable name was str23, now str26 to accommodate using data's values)
(note: variable hometown was str33, now str83 to accommodate using data's values)
(note: variable highschool was str71, now str99 to accommodate using data's values)
(note: variable sport was str20, now str23 to accommodate using data's values)
(note: variable college was str8, now str14 to accommodate using data's values)
file C:\Users\jrk5012\AppData\Local\Temp\ST_459c_000002.tmp saved
(6 vars, 535 obs)
(note: variable name was str24, now str26 to accommodate using data's values)
(note: variable hometown was str34, now str83 to accommodate using data's values)
(note: variable highschool was str52, now str99 to accommodate using data's values)
(note: variable sport was str20, now str23 to accommodate using data's values)
(note: variable college was str7, now str14 to accommodate using data's values)
file C:\Users\jrk5012\AppData\Local\Temp\ST_459c_000002.tmp saved
(6 vars, 562 obs)
(note: variable name was str23, now str26 to accommodate using data's values)
(note: variable hometown was str81, now str83 to accommodate using data's values)
(note: variable highschool was str91, now str99 to accommodate using data's values)
(note: variable sport was str20, now str23 to accommodate using data's values)
(note: variable college was str7, now str14 to accommodate using data's values)
file C:\Users\jrk5012\AppData\Local\Temp\ST_459c_000002.tmp saved
(6 vars, 646 obs)
(note: variable name was str22, now str26 to accommodate using data's values)
(note: variable hometown was str42, now str83 to accommodate using data's values)
(note: variable highschool was str60, now str99 to accommodate using data's values)
(note: variable sport was str20, now str23 to accommodate using data's values)
(note: variable college was str7, now str14 to accommodate using data's values)
file C:\Users\jrk5012\AppData\Local\Temp\ST_459c_000002.tmp saved
(6 vars, 626 obs)
(note: variable hometown was str43, now str83 to accommodate using data's values)
(note: variable highschool was str77, now str99 to accommodate using data's values)
(note: variable sport was str20, now str23 to accommodate using data's values)
(note: variable college was str4, now str14 to accommodate using data's values)
file C:\Users\jrk5012\AppData\Local\Temp\ST_459c_000002.tmp saved
(6 vars, 439 obs)
(note: variable name was str22, now str28 to accommodate using data's values)
(note: variable hometown was str31, now str83 to accommodate using data's values)
(note: variable highschool was str37, now str99 to accommodate using data's values)
(note: variable sport was str20, now str23 to accommodate using data's values)
(note: variable college was str10, now str14 to accommodate using data's values)
file C:\Users\jrk5012\AppData\Local\Temp\ST_459c_000002.tmp saved
(6 vars, 506 obs)
(note: variable name was str25, now str28 to accommodate using data's values)
(note: variable hometown was str29, now str83 to accommodate using data's values)
(note: variable highschool was str46, now str99 to accommodate using data's values)
(note: variable sport was str20, now str23 to accommodate using data's values)
(note: variable college was str6, now str14 to accommodate using data's values)
file C:\Users\jrk5012\AppData\Local\Temp\ST_459c_000002.tmp saved
(6 vars, 420 obs)
(note: variable name was str19, now str28 to accommodate using data's values)
(note: variable hometown was str45, now str83 to accommodate using data's values)
(note: variable highschool was str46, now str99 to accommodate using data's values)
(note: variable sport was str20, now str23 to accommodate using data's values)
(note: variable college was str12, now str14 to accommodate using data's values)
file C:\Users\jrk5012\AppData\Local\Temp\ST_459c_000002.tmp saved
(6 vars, 441 obs)
(note: variable name was str26, now str28 to accommodate using data's values)
(note: variable hometown was str33, now str83 to accommodate using data's values)
(note: variable highschool was str40, now str99 to accommodate using data's values)
(note: variable sport was str20, now str23 to accommodate using data's values)
(note: variable college was str8, now str14 to accommodate using data's values)
file C:\Users\jrk5012\AppData\Local\Temp\ST_459c_000002.tmp saved
(6 vars, 570 obs)
(note: variable hometown was str29, now str83 to accommodate using data's values)
(note: variable highschool was str65, now str99 to accommodate using data's values)
(note: variable sport was str20, now str23 to accommodate using data's values)
(note: variable college was str10, now str14 to accommodate using data's values)
file C:\Users\jrk5012\AppData\Local\Temp\ST_459c_000002.tmp saved
(6 vars, 527 obs)
(note: variable name was str23, now str29 to accommodate using data's values)
(note: variable hometown was str30, now str83 to accommodate using data's values)
(note: variable highschool was str54, now str99 to accommodate using data's values)
(note: variable sport was str20, now str23 to accommodate using data's values)
(note: variable college was str8, now str14 to accommodate using data's values)
file C:\Users\jrk5012\AppData\Local\Temp\ST_459c_000002.tmp saved
(6 vars, 407 obs)
(note: variable hometown was str42, now str83 to accommodate using data's values)
(note: variable highschool was str71, now str99 to accommodate using data's values)
(note: variable sport was str20, now str23 to accommodate using data's values)
(note: variable college was str5, now str14 to accommodate using data's values)
file C:\Users\jrk5012\AppData\Local\Temp\ST_459c_000002.tmp saved
(6 vars, 901 obs)
(note: variable name was str26, now str30 to accommodate using data's values)
(note: variable hometown was str29, now str83 to accommodate using data's values)
(note: variable highschool was str76, now str99 to accommodate using data's values)
(note: variable sport was str20, now str23 to accommodate using data's values)
(note: variable college was str8, now str14 to accommodate using data's values)
file C:\Users\jrk5012\AppData\Local\Temp\ST_459c_000002.tmp saved
(6 vars, 766 obs)
(note: variable name was str23, now str30 to accommodate using data's values)
(note: variable hometown was str26, now str83 to accommodate using data's values)
(note: variable highschool was str41, now str99 to accommodate using data's values)
(note: variable sport was str20, now str23 to accommodate using data's values)
file C:\Users\jrk5012\AppData\Local\Temp\ST_459c_000002.tmp saved
(6 vars, 692 obs)
(note: variable name was str24, now str30 to accommodate using data's values)
(note: variable hometown was str26, now str83 to accommodate using data's values)
(note: variable highschool was str69, now str99 to accommodate using data's values)
(note: variable sport was str20, now str23 to accommodate using data's values)
(note: variable college was str9, now str14 to accommodate using data's values)
file C:\Users\jrk5012\AppData\Local\Temp\ST_459c_000002.tmp saved
(6 vars, 406 obs)
(note: variable name was str24, now str30 to accommodate using data's values)
(note: variable hometown was str24, now str83 to accommodate using data's values)
(note: variable highschool was str41, now str99 to accommodate using data's values)
(note: variable sport was str20, now str23 to accommodate using data's values)
(note: variable college was str10, now str14 to accommodate using data's values)
file C:\Users\jrk5012\AppData\Local\Temp\ST_459c_000002.tmp saved
(6 vars, 528 obs)
(note: variable name was str25, now str30 to accommodate using data's values)
(note: variable hometown was str55, now str83 to accommodate using data's values)
(note: variable highschool was str32, now str99 to accommodate using data's values)
(note: variable sport was str20, now str23 to accommodate using data's values)
(note: variable college was str8, now str14 to accommodate using data's values)
file C:\Users\jrk5012\AppData\Local\Temp\ST_459c_000002.tmp saved
(6 vars, 703 obs)
(note: variable name was str23, now str30 to accommodate using data's values)
(note: variable hometown was str28, now str83 to accommodate using data's values)
(note: variable highschool was str50, now str99 to accommodate using data's values)
(note: variable sport was str20, now str23 to accommodate using data's values)
(note: variable college was str10, now str14 to accommodate using data's values)
file C:\Users\jrk5012\AppData\Local\Temp\ST_459c_000002.tmp saved
(6 vars, 403 obs)
(note: variable name was str21, now str30 to accommodate using data's values)
(note: variable hometown was str29, now str83 to accommodate using data's values)
(note: variable highschool was str39, now str99 to accommodate using data's values)
(note: variable sport was str20, now str23 to accommodate using data's values)
(note: variable college was str8, now str14 to accommodate using data's values)
file C:\Users\jrk5012\AppData\Local\Temp\ST_459c_000002.tmp saved
(6 vars, 437 obs)
(note: variable name was str25, now str30 to accommodate using data's values)
(note: variable hometown was str30, now str83 to accommodate using data's values)
(note: variable highschool was str43, now str99 to accommodate using data's values)
(note: variable college was str6, now str14 to accommodate using data's values)
file C:\Users\jrk5012\AppData\Local\Temp\ST_459c_000002.tmp saved
(6 vars, 489 obs)
(note: variable name was str24, now str30 to accommodate using data's values)
(note: variable hometown was str36, now str83 to accommodate using data's values)
(note: variable highschool was str47, now str99 to accommodate using data's values)
(note: variable sport was str20, now str23 to accommodate using data's values)
(note: variable college was str12, now str14 to accommodate using data's values)
file C:\Users\jrk5012\AppData\Local\Temp\ST_459c_000002.tmp saved
(6 vars, 841 obs)
(note: variable name was str25, now str30 to accommodate using data's values)
(note: variable hometown was str33, now str83 to accommodate using data's values)
(note: variable highschool was str43, now str99 to accommodate using data's values)
(note: variable sport was str20, now str23 to accommodate using data's values)
(note: variable college was str10, now str14 to accommodate using data's values)
file C:\Users\jrk5012\AppData\Local\Temp\ST_459c_000002.tmp saved
(6 vars, 489 obs)
(note: variable name was str24, now str30 to accommodate using data's values)
(note: variable hometown was str36, now str83 to accommodate using data's values)
(note: variable highschool was str74, now str99 to accommodate using data's values)
(note: variable sport was str20, now str23 to accommodate using data's values)
(note: variable college was str4, now str14 to accommodate using data's values)
file C:\Users\jrk5012\AppData\Local\Temp\ST_459c_000002.tmp saved
(6 vars, 377 obs)
(note: variable name was str27, now str30 to accommodate using data's values)
(note: variable hometown was str72, now str83 to accommodate using data's values)
(note: variable highschool was str78, now str99 to accommodate using data's values)
(note: variable sport was str17, now str23 to accommodate using data's values)
(note: variable college was str6, now str14 to accommodate using data's values)
file C:\Users\jrk5012\AppData\Local\Temp\ST_459c_000002.tmp saved
(6 vars, 642 obs)
(note: variable name was str24, now str30 to accommodate using data's values)
(note: variable hometown was str35, now str83 to accommodate using data's values)
(note: variable highschool was str49, now str99 to accommodate using data's values)
(note: variable sport was str20, now str23 to accommodate using data's values)
(note: variable college was str7, now str14 to accommodate using data's values)
file C:\Users\jrk5012\AppData\Local\Temp\ST_459c_000002.tmp saved
(6 vars, 553 obs)
(note: variable hometown was str34, now str83 to accommodate using data's values)
(note: variable highschool was str41, now str99 to accommodate using data's values)
file C:\Users\jrk5012\AppData\Local\Temp\ST_459c_000002.tmp saved
(6 vars, 856 obs)
(note: variable name was str25, now str30 to accommodate using data's values)
(note: variable hometown was str45, now str83 to accommodate using data's values)
(note: variable highschool was str47, now str99 to accommodate using data's values)
(note: variable college was str8, now str14 to accommodate using data's values)
file C:\Users\jrk5012\AppData\Local\Temp\ST_459c_000002.tmp saved
(6 vars, 565 obs)
(note: variable name was str23, now str30 to accommodate using data's values)
(note: variable hometown was str38, now str83 to accommodate using data's values)
(note: variable highschool was str65, now str99 to accommodate using data's values)
(note: variable sport was str19, now str23 to accommodate using data's values)
(note: variable college was str8, now str14 to accommodate using data's values)
file C:\Users\jrk5012\AppData\Local\Temp\ST_459c_000002.tmp saved
(6 vars, 445 obs)
(note: variable name was str22, now str30 to accommodate using data's values)
(note: variable hometown was str36, now str83 to accommodate using data's values)
(note: variable highschool was str41, now str99 to accommodate using data's values)
(note: variable college was str3, now str14 to accommodate using data's values)
file C:\Users\jrk5012\AppData\Local\Temp\ST_459c_000002.tmp saved
(6 vars, 476 obs)
(note: variable name was str22, now str30 to accommodate using data's values)
(note: variable hometown was str28, now str83 to accommodate using data's values)
(note: variable highschool was str76, now str99 to accommodate using data's values)
(note: variable sport was str17, now str23 to accommodate using data's values)
(note: variable college was str9, now str14 to accommodate using data's values)
file C:\Users\jrk5012\AppData\Local\Temp\ST_459c_000002.tmp saved
(6 vars, 510 obs)
(note: variable name was str23, now str30 to accommodate using data's values)
(note: variable hometown was str33, now str83 to accommodate using data's values)
(note: variable highschool was str40, now str99 to accommodate using data's values)
(note: variable sport was str17, now str23 to accommodate using data's values)
(note: variable college was str5, now str14 to accommodate using data's values)
file C:\Users\jrk5012\AppData\Local\Temp\ST_459c_000002.tmp saved
(6 vars, 601 obs)
(note: variable name was str26, now str30 to accommodate using data's values)
(note: variable hometown was str33, now str83 to accommodate using data's values)
(note: variable highschool was str63, now str99 to accommodate using data's values)
(note: variable sport was str20, now str23 to accommodate using data's values)
(note: variable college was str8, now str14 to accommodate using data's values)
file C:\Users\jrk5012\AppData\Local\Temp\ST_459c_000002.tmp saved
(6 vars, 437 obs)
(note: variable name was str26, now str30 to accommodate using data's values)
(note: variable highschool was str83, now str99 to accommodate using data's values)
(note: variable sport was str20, now str23 to accommodate using data's values)
(note: variable college was str10, now str14 to accommodate using data's values)
file C:\Users\jrk5012\AppData\Local\Temp\ST_459c_000002.tmp saved
(6 vars, 651 obs)
(note: variable name was str24, now str30 to accommodate using data's values)
(note: variable hometown was str40, now str90 to accommodate using data's values)
(note: variable highschool was str49, now str99 to accommodate using data's values)
(note: variable college was str4, now str14 to accommodate using data's values)
file C:\Users\jrk5012\AppData\Local\Temp\ST_459c_000002.tmp saved
(6 vars, 774 obs)
(note: variable name was str24, now str30 to accommodate using data's values)
(note: variable hometown was str30, now str90 to accommodate using data's values)
(note: variable highschool was str57, now str99 to accommodate using data's values)
(note: variable sport was str20, now str23 to accommodate using data's values)
file C:\Users\jrk5012\AppData\Local\Temp\ST_459c_000002.tmp saved
(6 vars, 554 obs)
(note: variable name was str28, now str30 to accommodate using data's values)
(note: variable hometown was str88, now str90 to accommodate using data's values)
(note: variable college was str3, now str14 to accommodate using data's values)
file C:\Users\jrk5012\AppData\Local\Temp\ST_459c_000002.tmp saved
(6 vars, 466 obs)
(note: variable name was str24, now str30 to accommodate using data's values)
(note: variable hometown was str34, now str90 to accommodate using data's values)
(note: variable highschool was str79, now str154 to accommodate using data's values)
(note: variable college was str4, now str14 to accommodate using data's values)
file C:\Users\jrk5012\AppData\Local\Temp\ST_459c_000002.tmp saved
(6 vars, 343 obs)
(note: variable name was str21, now str30 to accommodate using data's values)
(note: variable hometown was str46, now str90 to accommodate using data's values)
(note: variable highschool was str40, now str154 to accommodate using data's values)
(note: variable sport was str20, now str23 to accommodate using data's values)
(note: variable college was str10, now str14 to accommodate using data's values)
file C:\Users\jrk5012\AppData\Local\Temp\ST_459c_000002.tmp saved
(6 vars, 663 obs)
(note: variable name was str25, now str30 to accommodate using data's values)
(note: variable hometown was str39, now str90 to accommodate using data's values)
(note: variable highschool was str73, now str154 to accommodate using data's values)
(note: variable sport was str19, now str23 to accommodate using data's values)
(note: variable college was str8, now str14 to accommodate using data's values)
file C:\Users\jrk5012\AppData\Local\Temp\ST_459c_000002.tmp saved
(6 vars, 581 obs)
(note: variable name was str24, now str30 to accommodate using data's values)
(note: variable hometown was str40, now str90 to accommodate using data's values)
(note: variable highschool was str46, now str154 to accommodate using data's values)
(note: variable sport was str20, now str23 to accommodate using data's values)
(note: variable college was str13, now str14 to accommodate using data's values)
file C:\Users\jrk5012\AppData\Local\Temp\ST_459c_000002.tmp saved
(6 vars, 424 obs)
(note: variable name was str28, now str30 to accommodate using data's values)
(note: variable hometown was str28, now str90 to accommodate using data's values)
(note: variable highschool was str38, now str154 to accommodate using data's values)
(note: variable sport was str20, now str23 to accommodate using data's values)
(note: variable college was str11, now str14 to accommodate using data's values)
file C:\Users\jrk5012\AppData\Local\Temp\ST_459c_000002.tmp saved
(6 vars, 564 obs)
(note: variable name was str22, now str30 to accommodate using data's values)
(note: variable hometown was str35, now str90 to accommodate using data's values)
(note: variable highschool was str40, now str154 to accommodate using data's values)
(note: variable college was str10, now str14 to accommodate using data's values)
file C:\Users\jrk5012\AppData\Local\Temp\ST_459c_000002.tmp saved
(6 vars, 451 obs)
(note: variable name was str24, now str30 to accommodate using data's values)
(note: variable hometown was str31, now str90 to accommodate using data's values)
(note: variable highschool was str39, now str154 to accommodate using data's values)
(note: variable sport was str20, now str23 to accommodate using data's values)
file C:\Users\jrk5012\AppData\Local\Temp\ST_459c_000002.tmp saved
(6 vars, 513 obs)
(note: variable name was str25, now str30 to accommodate using data's values)
(note: variable hometown was str47, now str90 to accommodate using data's values)
(note: variable highschool was str83, now str154 to accommodate using data's values)
(note: variable sport was str20, now str23 to accommodate using data's values)
(note: variable college was str13, now str16 to accommodate using data's values)
file C:\Users\jrk5012\AppData\Local\Temp\ST_459c_000002.tmp saved
(6 vars, 796 obs)
(note: variable name was str27, now str30 to accommodate using data's values)
(note: variable hometown was str82, now str90 to accommodate using data's values)
(note: variable highschool was str39, now str154 to accommodate using data's values)
(note: variable sport was str20, now str23 to accommodate using data's values)
(note: variable college was str9, now str16 to accommodate using data's values)
file C:\Users\jrk5012\AppData\Local\Temp\ST_459c_000002.tmp saved
(7 vars, 581 obs)
(note: file C:\Users\jrk5012\AppData\Local\Temp\ST_459c_000003.tmp not found)
file C:\Users\jrk5012\AppData\Local\Temp\ST_459c_000003.tmp saved
(7 vars, 441 obs)
(note: variable hometown was str34, now str38 to accommodate using data's values)
(note: variable high_school was str40, now str56 to accommodate using data's values)
(note: variable college was str3, now str4 to accommodate using data's values)
file C:\Users\jrk5012\AppData\Local\Temp\ST_459c_000003.tmp saved
(7 vars, 628 obs)
(note: variable name was str21, now str29 to accommodate using data's values)
(note: variable hometown was str27, now str38 to accommodate using data's values)
(note: variable high_school was str42, now str56 to accommodate using data's values)
file C:\Users\jrk5012\AppData\Local\Temp\ST_459c_000003.tmp saved
(7 vars, 457 obs)
(note: variable name was str22, now str29 to accommodate using data's values)
(note: variable hometown was str30, now str38 to accommodate using data's values)
(note: variable sport was str19, now str23 to accommodate using data's values)
file C:\Users\jrk5012\AppData\Local\Temp\ST_459c_000003.tmp saved

. 
. // unordered lists - easy
. use `uls', clear

. replace highschool = "" if highschool == "N/A"
(2,434 real changes made)

. replace highschool = stritrim(highschool)
(267 real changes made)

. tempfile full

. save `full'
file C:\Users\jrk5012\AppData\Local\Temp\ST_459c_000004.tmp saved

. 
. // grids - easy
. use `grids', clear

. rename high_school highschool

. assert !missing(highschool) & highschool != "N/A"

. replace highschool = stritrim(highschool)
(0 real changes made)

. // fix sport name in cases where gender specified
. replace sport = subinstr(sport, "mixed", "mens", 1) if gender == "Men"
(289 real changes made)

. replace sport = subinstr(sport, "mixed", "womens", 1) if gender == "Women"
(344 real changes made)

. drop gender

. append using `full'
(note: variable name was str29, now str30 to accommodate using data's values)
(note: variable hometown was str38, now str90 to accommodate using data's values)
(note: variable highschool was str60, now str154 to accommodate using data's values)
(note: variable college was str8, now str16 to accommodate using data's values)

. save `full', replace
file C:\Users\jrk5012\AppData\Local\Temp\ST_459c_000004.tmp saved

. 
. // tables - harder but more structured
. use `tables', clear

. foreach v of varlist *text {
  2.         replace `v' = upper(`v')
  3. }
(4,629 real changes made)
(3,264 real changes made)
(2,637 real changes made)
(3,167 real changes made)

. tab hometowntext

           hometown text |      Freq.     Percent        Cum.
-------------------------+-----------------------------------
                HOMETOWN |      3,639       78.61       78.61
  HOMETOWN / HIGH SCHOOL |        751       16.22       94.84
           HOMETOWN / HS |        119        2.57       97.41
  HOMETOWN / LAST SCHOOL |          9        0.19       97.60
    HOMETOWN/HIGH SCHOOL |         39        0.84       98.44
HOMETOWN/PREVIOUS SCHOOL |         10        0.22       98.66
                     N/A |         62        1.34      100.00
-------------------------+-----------------------------------
                   Total |      4,629      100.00

. tab highschooltext

                    high school text |      Freq.     Percent        Cum.
-------------------------------------+-----------------------------------
                         HIGH SCHOOL |      1,115       24.09       24.09
           HIGH SCHOOL (LAST SCHOOL) |         57        1.23       25.32
       HIGH SCHOOL (PREVIOUS SCHOOL) |          8        0.17       25.49
HIGH SCHOOL (PREVIOUS SCHOOL) / CLUB |         30        0.65       26.14
       HIGH SCHOOL / PREVIOUS SCHOOL |        125        2.70       28.84
             HIGH SCHOOL/LAST SCHOOL |        106        2.29       31.13
         HIGH SCHOOL/PREVIOUS SCHOOL |        406        8.77       39.90
              HOMETOWN / HIGH SCHOOL |        751       16.22       56.12
                HOMETOWN/HIGH SCHOOL |         39        0.84       56.97
                                 N/A |      1,992       43.03      100.00
-------------------------------------+-----------------------------------
                               Total |      4,629      100.00

. gen ht_hs_same = hometowntext == highschooltext

. tab ht_hs_same

 ht_hs_same |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |      3,839       82.93       82.93
          1 |        790       17.07      100.00
------------+-----------------------------------
      Total |      4,629      100.00

. 
. ** basic cases
. gen ht_clean = hometown if hometowntext == "HOMETOWN"
(1,032 missing values generated)

. gen hs_clean = highschool if highschooltext == "HIGH SCHOOL"
(3,527 missing values generated)

. 
. replace ht_clean = strtrim(substr(hometown, strpos(hometown, "-") + 1, .)) ///
>                                         if hometowntext == "LAST SCHOOL - HOMETOWN"
(0 real changes made)

. 
. ** hometown is always first other than the one above
. local chr_list "(" "-" "/"

. foreach chr in "`chr_list'" {
  2.         replace ht_clean = strtrim(substr(hometown, 1, strpos(hometown, "`chr'")-1)) ///
>                 if missing(ht_clean) & strpos(hometowntext, "`chr'") != 0 & hometowntext != "N/A"
  3. 
.         replace ht_clean = hometown if strpos(hometowntext, "`chr'") > 0 & ///
>                 strpos(hometown, "`chr'") == 0 & missing(ht_clean)
  4. }
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(922 real changes made)
(4 real changes made)

. 
. ** if hometown not in high school field, high school is always first
. ** same approach as with hometown above
. local chr_list "(" "/"

. foreach chr in "`chr_list'" {
  2.         replace hs_clean = strtrim(substr(highschool, 1, strpos(highschool, "`chr'")-1)) ///
>                 if strpos(highschooltext, "HOMETOWN") == 0 & missing(hs_clean) & highschooltext != "N/A"
  3. 
.         replace hs_clean = highschool if strpos(highschooltext, "HOMETOWN") == 0 & ///
>                 missing(hs_clean) & highschooltext != "N/A" & ///
>                 strpos(highschool, "`chr'") == 0 & strpos(highschooltext, "`chr'") > 0
  4. }
variable hs_clean was str39 now str44
(21 real changes made)
variable hs_clean was str44 now str56
(87 real changes made)
(76 real changes made)
(543 real changes made)

. 
. ** cases where hometown and high school need to be separated
. tempvar x

. gen `x' = strpos(highschool, "(") + 1

. replace hs_clean = strtrim(substr(highschool, `x', strlen(highschool) - `x')) ///
>         if highschooltext == "HOMETOWN (HIGH SCHOOL)" & strpos(highschool, "(") > 0
(0 real changes made)

. drop `x'

. 
. tempvar x

. gen `x' = strpos(highschool, "/") + 1

. replace hs_clean = strtrim(substr(highschool, `x', .)) ///
>         if inlist(highschooltext, "HOMETOWN / HIGH SCHOOL", "HOMETOWN/HIGH SCHOOL") & `x' > 1
variable hs_clean was str56 now str66
(779 real changes made)

. 
. ** high school if between /
. replace hs_clean = strtrim(substr(highschool, `x', strrpos(highschool, "/") - `x')) ///
>         if strrpos(highschool, "/") > strpos(highschool, "/") & strrpos(highschool, "/") > 0 & ///
>         inlist(highschooltext, "HOMETOWN/HIGH SCHOOL/COLLEGE", ///
>                                                    "HOMETOWN/HIGH SCHOOL/LAST COLLEGE", ///
>                                                    "HOMETOWN/HIGH SCHOOL/LAST SCHOOL", ///
>                                                    "HOMETOWN/HIGH SCHOOL/PREV. COLLEGE", ///
>                                                    "HOMETOWN/HIGH SCHOOL/PREVIOUS COLLEGE", ///
>                                                    "HOMETOWN/HIGH SCHOOL/PREVIOUS SCHOOL")
(0 real changes made)

. 
. ** high school if no other/previous school
. replace hs_clean = strtrim(substr(highschool, `x', .)) ///
>         if strrpos(highschool, "/") == strpos(highschool, "/") & strrpos(highschool, "/") > 0 & ///
>         inlist(highschooltext, "HOMETOWN/HIGH SCHOOL/COLLEGE", ///
>                                                    "HOMETOWN/HIGH SCHOOL/LAST COLLEGE", ///
>                                                    "HOMETOWN/HIGH SCHOOL/LAST SCHOOL", ///
>                                                    "HOMETOWN/HIGH SCHOOL/PREV. COLLEGE", ///
>                                                    "HOMETOWN/HIGH SCHOOL/PREVIOUS COLLEGE", ///
>                                                    "HOMETOWN/HIGH SCHOOL/PREVIOUS SCHOOL")
(0 real changes made)

. drop `x'

. 
. 
. ** now need to use "school" field where highschooltext == "N/A"
. gen ls_clean = ""
(4,629 missing values generated)

. la var ls_clean "Last/Previous School"

. // list school if missing(hs_clean) & schooltext == "HOMETOWN (LAST SCHOOL)"
. 
. replace ls_clean = school if inlist(schooltext, "LAST SCHOOL", "PREV SCHOOL", "PREVIOUS SCHOOL")
variable ls_clean was str1 now str51
(1,211 real changes made)

. 
. tempvar x

. gen `x' = strpos(school, "(") + 1

. replace ls_clean = strtrim(substr(school, `x', strlen(school) - `x')) ///
>         if inlist(schooltext, "HOMETOWN (LAST SCHOOL)", "HOMETOWN (PREV SCHOOL)") & strpos(school, "(") > 0
(0 real changes made)

. drop `x'

. 
. tempvar x

. gen `x' = strpos(school, "-") + 1

. replace ls_clean = strtrim(substr(school, `x', strlen(school) - `x')) ///
>         if inlist(schooltext, "HOMETOWN - LAST SCHOOL") & strpos(school, "-") > 0
(0 real changes made)

. replace ls_clean = strtrim(substr(school, 1, `x' - 1)) ///
>         if schooltext == "LAST SCHOOL - HOMETOWN" & strpos(school, "-") > 0
(0 real changes made)

. drop `x'

. 
. tempvar x

. gen `x' = strpos(school, "/") + 1

. replace ls_clean = strtrim(substr(school, `x', strlen(school) - `x')) ///
>         if inlist(schooltext, "HOMETOWN / LAST SCHOOL", "HOMETOWN / PREVIOUS SCHOOL", ///
>         "HOMETOWN/LAST SCHOOL", "HOMETOWN/PREVIOUS SCHOOL") & strpos(school, "/") > 0
(19 real changes made)

. drop `x'

. 
. // converting these + high school to "prevschool" variable
. replace hs_clean = ls_clean if missing(hs_clean)
(1,230 real changes made)

. 
. replace ht_clean = strtrim(stritrim(ht_clean))
(0 real changes made)

. replace hs_clean = strtrim(stritrim(hs_clean))
(3 real changes made)

. 
. keep name ht_clean hs_clean sport college

. rename ht_clean hometown

. rename hs_clean highschool

. 
. append using `full'
(note: variable hometown was str40, now str90 to accommodate using data's values)
(note: variable highschool was str66, now str154 to accommodate using data's values)
(note: variable college was str14, now str16 to accommodate using data's values)

. 
. rename highschool prevschool

. 
. compress
  variable prevschool was str154 now str83
  (2,540,451 bytes saved)

. save `full', replace
file C:\Users\jrk5012\AppData\Local\Temp\ST_459c_000004.tmp saved

. 
. 
. *******************************************************************************
. use `full', clear

. //  clean hometown variable and match to correct state variable
. parse_hometown, hometown(hometown) city(city) state(state)
(106 missing values generated)
(10 real changes made)
(630 real changes made)
(109 real changes made)
(870 missing values generated)
(106 missing values generated)

. do _match_state_abbrev.do

. // dummy example
. 
. // // make crosswalk
. // clear
. // set obs 2
. // forvalues i = 1/3 {
. //      gen x`i' = ""
. // }
. //
. // replace x1 = "IN" in 1
. // replace x1 = "IL" in 2
. // replace x2 = "Ind." in 1
. // replace x2 = "Ill." in 2
. // replace x3 = "Indiana" in 1
. // replace x3 = "Illinois" in 2
. //
. // tempfile crosswalk
. // save `crosswalk', replace
. //
. // // make data
. // clear
. // set obs 8
. // gen state = ""
. // replace state = "Ind." in 1
. // replace state = "Ill." in 2
. // replace state = "IN" in 3
. // replace state = "Illinois" in 4
. // replace state = "Ind." in 5
. // replace state = "Ill." in 6
. // replace state = "IN" in 7
. // replace state = "Illi" in 8
. //
. // // algorithm
. // gen desired_state = ""
. // forval j = 1/3 {
. //      gen x`j' = state
. //      merge m:1 x`j' using `crosswalk', keep(1 3) keepusing(x1)
. //      replace desired_state = x1 if _merge==3
. //      drop x`j' _merge
. //      cap drop x1
. // }
. 
. ****************************************************************************
. // _match_state_abbrev
. * attempts to merge the state variable with all possible types in state_abbrevs
. quietly {

. 
end of do-file

. gen nonUS = missing(desired_state)

. rename state state_country_raw

. order state_country_raw, after(hometown)

. rename desired_state state

. replace city = "" if missing(state)
(3,236 real changes made)

. 
. rename nonUS nonUSmatch

. 
. // check false positives
. preserve

.         drop if missing(state)
(4,105 observations deleted)

.         levelsof state, local(states)
`"AK"' `"AL"' `"AR"' `"AZ"' `"CA"' `"CO"' `"CT"' `"DC"' `"DE"' `"FL"' `"GA"' `"HI"' `"IA"' `"ID"' `"IL"' `"IN"' `"KS"' `"KY"' `"LA"' `"MA"' `"MD"' `"ME"' `"MI"' `"MN"' `"MO"' `"MS"' `
> "MT"' `"NC"' `"ND"' `"NE"' `"NH"' `"NJ"' `"NM"' `"NV"' `"NY"' `"OH"' `"OK"' `"OR"' `"PA"' `"RI"' `"SC"' `"SD"' `"TN"' `"TX"' `"UT"' `"VA"' `"VT"' `"WA"' `"WI"' `"WV"' `"WY"'

.         foreach state in `states' {
  2.                 disp "`state'"
  3.                 tab state_country_raw if state=="`state'"
  4.                 disp ""
  5.                 disp "***************************"
  6.         }
AK

                      state_country_raw |      Freq.     Percent        Cum.
----------------------------------------+-----------------------------------
                                     AK |          3       14.29       14.29
                                 Alaska |         18       85.71      100.00
----------------------------------------+-----------------------------------
                                  Total |         21      100.00

***************************
AL

                      state_country_raw |      Freq.     Percent        Cum.
----------------------------------------+-----------------------------------
                                     AL |         48        9.38        9.38
                                    Ala |          1        0.20        9.57
                                   Ala. |        459       89.65       99.22
                                Alabama |          4        0.78      100.00
----------------------------------------+-----------------------------------
                                  Total |        512      100.00

***************************
AR

                      state_country_raw |      Freq.     Percent        Cum.
----------------------------------------+-----------------------------------
                                     AR |         10        5.41        5.41
                                    Ark |          3        1.62        7.03
                                   Ark. |        167       90.27       97.30
                               Arkansas |          5        2.70      100.00
----------------------------------------+-----------------------------------
                                  Total |        185      100.00

***************************
AZ

                      state_country_raw |      Freq.     Percent        Cum.
----------------------------------------+-----------------------------------
                                     AZ |         18        3.38        3.38
                                    AZ. |          1        0.19        3.56
                                   Ariz |          7        1.31        4.88
                                  Ariz. |        499       93.62       98.50
                                Arizona |          7        1.31       99.81
                                    Az. |          1        0.19      100.00
----------------------------------------+-----------------------------------
                                  Total |        533      100.00

***************************
CA

                      state_country_raw |      Freq.     Percent        Cum.
----------------------------------------+-----------------------------------
                                     CA |        281        7.72        7.72
                                    CA. |          2        0.05        7.77
                                    Ca. |         12        0.33        8.10
                                   Cal. |          4        0.11        8.21
                                  Calif |         20        0.55        8.76
                                 Calif. |      3,290       90.33       99.09
                             California |         33        0.91      100.00
----------------------------------------+-----------------------------------
                                  Total |      3,642      100.00

***************************
CO

                      state_country_raw |      Freq.     Percent        Cum.
----------------------------------------+-----------------------------------
                                     CO |         18        2.94        2.94
                                    Co. |          5        0.82        3.75
                                   Col. |          6        0.98        4.73
                                  Colo. |        566       92.33       97.06
                               Colorado |         18        2.94      100.00
----------------------------------------+-----------------------------------
                                  Total |        613      100.00

***************************
CT

                      state_country_raw |      Freq.     Percent        Cum.
----------------------------------------+-----------------------------------
                                     CT |         15        4.85        4.85
                                    CT. |          1        0.32        5.18
                                   Conn |          1        0.32        5.50
                                  Conn. |        284       91.91       97.41
                            Connecticut |          6        1.94       99.35
                                    Ct. |          2        0.65      100.00
----------------------------------------+-----------------------------------
                                  Total |        309      100.00

***************************
DC

                      state_country_raw |      Freq.     Percent        Cum.
----------------------------------------+-----------------------------------
                                   D.C. |         70       89.74       89.74
                                     DC |          8       10.26      100.00
----------------------------------------+-----------------------------------
                                  Total |         78      100.00

***************************
DE

                      state_country_raw |      Freq.     Percent        Cum.
----------------------------------------+-----------------------------------
                                     DE |          2        3.03        3.03
                                    De. |          1        1.52        4.55
                                   Del. |         63       95.45      100.00
----------------------------------------+-----------------------------------
                                  Total |         66      100.00

***************************
FL

                      state_country_raw |      Freq.     Percent        Cum.
----------------------------------------+-----------------------------------
                                     FL |        100        4.93        4.93
                                    Fl. |          3        0.15        5.07
                                    Fla |          6        0.30        5.37
                                   Fla. |      1,888       93.00       98.37
                                Florida |         33        1.63      100.00
----------------------------------------+-----------------------------------
                                  Total |      2,030      100.00

***************************
GA

                      state_country_raw |      Freq.     Percent        Cum.
----------------------------------------+-----------------------------------
                                     GA |         78        4.83        4.83
                                    GA. |          2        0.12        4.95
                                     Ga |          5        0.31        5.26
                                    Ga. |      1,508       93.37       98.64
                                Georgia |         22        1.36      100.00
----------------------------------------+-----------------------------------
                                  Total |      1,615      100.00

***************************
HI

                      state_country_raw |      Freq.     Percent        Cum.
----------------------------------------+-----------------------------------
                                     HI |         12        8.11        8.11
                                   Haw. |          1        0.68        8.78
                                Hawai'i |         34       22.97       31.76
                                 Hawaii |        100       67.57       99.32
                                     Hi |          1        0.68      100.00
----------------------------------------+-----------------------------------
                                  Total |        148      100.00

***************************
IA

                      state_country_raw |      Freq.     Percent        Cum.
----------------------------------------+-----------------------------------
                                     IA |         16        2.88        2.88
                                    Ia. |          1        0.18        3.06
                                   Iowa |        537       96.76       99.82
                                  Iowa. |          1        0.18      100.00
----------------------------------------+-----------------------------------
                                  Total |        555      100.00

***************************
ID

                      state_country_raw |      Freq.     Percent        Cum.
----------------------------------------+-----------------------------------
                                     ID |          3        3.85        3.85
                                    Id. |          1        1.28        5.13
                                  Idaho |         74       94.87      100.00
----------------------------------------+-----------------------------------
                                  Total |         78      100.00

***************************
IL

                      state_country_raw |      Freq.     Percent        Cum.
----------------------------------------+-----------------------------------
                                     IL |         69        4.62        4.62
                                    IL. |          1        0.07        4.69
                                   ILL. |          1        0.07        4.76
                                    Ill |         11        0.74        5.49
                                   Ill. |      1,361       91.16       96.65
                               Illinois |         50        3.35      100.00
----------------------------------------+-----------------------------------
                                  Total |      1,493      100.00

***************************
IN

                      state_country_raw |      Freq.     Percent        Cum.
----------------------------------------+-----------------------------------
                                     IN |         33        4.18        4.18
                                    In. |          2        0.25        4.43
                                    Ind |          1        0.13        4.56
                                   Ind. |        738       93.42       97.97
                                Indiana |         16        2.03      100.00
----------------------------------------+-----------------------------------
                                  Total |        790      100.00

***************************
KS

                      state_country_raw |      Freq.     Percent        Cum.
----------------------------------------+-----------------------------------
                                     KS |          7        1.41        1.41
                                   Kan. |        438       88.13       89.54
                                 Kansas |         48        9.66       99.20
                                     Ks |          1        0.20       99.40
                                    Ks. |          3        0.60      100.00
----------------------------------------+-----------------------------------
                                  Total |        497      100.00

***************************
KY

                      state_country_raw |      Freq.     Percent        Cum.
----------------------------------------+-----------------------------------
                                  KENT. |          1        0.28        0.28
                                     KY |         10        2.79        3.07
                                    KY. |          1        0.28        3.35
                               Kentucky |          8        2.23        5.59
                                     Ky |          1        0.28        5.87
                                    Ky. |        337       94.13      100.00
----------------------------------------+-----------------------------------
                                  Total |        358      100.00

***************************
LA

                      state_country_raw |      Freq.     Percent        Cum.
----------------------------------------+-----------------------------------
                                     LA |         28        6.91        6.91
                                    La. |        374       92.35       99.26
                              Louisiana |          3        0.74      100.00
----------------------------------------+-----------------------------------
                                  Total |        405      100.00

***************************
MA

                      state_country_raw |      Freq.     Percent        Cum.
----------------------------------------+-----------------------------------
                                     MA |         22        4.08        4.08
                                     MS |        113       20.96       25.05
                                    Ma. |          4        0.74       25.79
                                   Mass |          2        0.37       26.16
                                  Mass. |        393       72.91       99.07
                          Massachusetts |          5        0.93      100.00
----------------------------------------+-----------------------------------
                                  Total |        539      100.00

***************************
MD

                      state_country_raw |      Freq.     Percent        Cum.
----------------------------------------+-----------------------------------
                                     MD |         50        6.56        6.56
                                    MD. |          9        1.18        7.74
                               Maryland |          7        0.92        8.66
                                     Md |          4        0.52        9.19
                                    Md. |        692       90.81      100.00
----------------------------------------+-----------------------------------
                                  Total |        762      100.00

***************************
ME

                      state_country_raw |      Freq.     Percent        Cum.
----------------------------------------+-----------------------------------
                                  Maine |         24       96.00       96.00
                                    Me. |          1        4.00      100.00
----------------------------------------+-----------------------------------
                                  Total |         25      100.00

***************************
MI

                      state_country_raw |      Freq.     Percent        Cum.
----------------------------------------+-----------------------------------
                                   Mich |          6        0.52        0.52
                                  Mich. |      1,122       97.91       98.43
                               Michigan |         18        1.57      100.00
----------------------------------------+-----------------------------------
                                  Total |      1,146      100.00

***************************
MN

                      state_country_raw |      Freq.     Percent        Cum.
----------------------------------------+-----------------------------------
                                     MN |         20        2.91        2.91
                                   Minn |          2        0.29        3.20
                                  Minn. |        648       94.32       97.53
                              Minnesota |         17        2.47      100.00
----------------------------------------+-----------------------------------
                                  Total |        687      100.00

***************************
MO

                      state_country_raw |      Freq.     Percent        Cum.
----------------------------------------+-----------------------------------
                                     MO |         14        2.67        2.67
                                    MO. |          1        0.19        2.86
                               Missouri |         24        4.57        7.43
                                     Mo |          3        0.57        8.00
                                    Mo. |        483       92.00      100.00
----------------------------------------+-----------------------------------
                                  Total |        525      100.00

***************************
MS

                      state_country_raw |      Freq.     Percent        Cum.
----------------------------------------+-----------------------------------
                                     MI |         33       15.87       15.87
                                   Miss |          2        0.96       16.83
                                  Miss. |        171       82.21       99.04
                            Mississippi |          2        0.96      100.00
----------------------------------------+-----------------------------------
                                  Total |        208      100.00

***************************
MT

                      state_country_raw |      Freq.     Percent        Cum.
----------------------------------------+-----------------------------------
                                   Mont |          1        2.04        2.04
                                  Mont. |         47       95.92       97.96
                                Montana |          1        2.04      100.00
----------------------------------------+-----------------------------------
                                  Total |         49      100.00

***************************
NC

                      state_country_raw |      Freq.     Percent        Cum.
----------------------------------------+-----------------------------------
                                   N.C. |        961       94.03       94.03
                                     NC |         56        5.48       99.51
                         North Carolina |          5        0.49      100.00
----------------------------------------+-----------------------------------
                                  Total |      1,022      100.00

***************************
ND

                      state_country_raw |      Freq.     Percent        Cum.
----------------------------------------+-----------------------------------
                                   N.D. |         27       96.43       96.43
                           North Dakota |          1        3.57      100.00
----------------------------------------+-----------------------------------
                                  Total |         28      100.00

***************************
NE

                      state_country_raw |      Freq.     Percent        Cum.
----------------------------------------+-----------------------------------
                                    Neb |          1        0.36        0.36
                                   Neb. |        271       96.44       96.80
                               Nebraska |          9        3.20      100.00
----------------------------------------+-----------------------------------
                                  Total |        281      100.00

***************************
NH

                      state_country_raw |      Freq.     Percent        Cum.
----------------------------------------+-----------------------------------
                                    N.H |          1        1.69        1.69
                                   N.H. |         52       88.14       89.83
                                     NH |          4        6.78       96.61
                          New Hampshire |          2        3.39      100.00
----------------------------------------+-----------------------------------
                                  Total |         59      100.00

***************************
NJ

                      state_country_raw |      Freq.     Percent        Cum.
----------------------------------------+-----------------------------------
                                  N. J. |          2        0.17        0.17
                                    N.J |          3        0.25        0.42
                                   N.J. |      1,097       92.03       92.45
                                     NJ |         81        6.80       99.24
                             New Jersey |          9        0.76      100.00
----------------------------------------+-----------------------------------
                                  Total |      1,192      100.00

***************************
NM

                      state_country_raw |      Freq.     Percent        Cum.
----------------------------------------+-----------------------------------
                                   N.M. |         47       79.66       79.66
                                     NM |          7       11.86       91.53
                             New Mexico |          5        8.47      100.00
----------------------------------------+-----------------------------------
                                  Total |         59      100.00

***************************
NV

                      state_country_raw |      Freq.     Percent        Cum.
----------------------------------------+-----------------------------------
                                     NV |         11        7.14        7.14
                                    NV. |          1        0.65        7.79
                                   Nev. |        134       87.01       94.81
                                 Nevada |          8        5.19      100.00
----------------------------------------+-----------------------------------
                                  Total |        154      100.00

***************************
NY

                      state_country_raw |      Freq.     Percent        Cum.
----------------------------------------+-----------------------------------
                                    N.Y |          4        0.42        0.42
                                   N.Y. |        850       89.76       90.18
                                     NY |         74        7.81       97.99
                               New York |         19        2.01      100.00
----------------------------------------+-----------------------------------
                                  Total |        947      100.00

***************************
OH

                      state_country_raw |      Freq.     Percent        Cum.
----------------------------------------+-----------------------------------
                                     OH |         60        5.16        5.16
                                    Oh. |          6        0.52        5.67
                                   Ohio |      1,096       94.24       99.91
                                  Ohio. |          1        0.09      100.00
----------------------------------------+-----------------------------------
                                  Total |      1,163      100.00

***************************
OK

                      state_country_raw |      Freq.     Percent        Cum.
----------------------------------------+-----------------------------------
                                     OK |         45       11.03       11.03
                                  Okla. |        320       78.43       89.46
                               Oklahoma |         43       10.54      100.00
----------------------------------------+-----------------------------------
                                  Total |        408      100.00

***************************
OR

                      state_country_raw |      Freq.     Percent        Cum.
----------------------------------------+-----------------------------------
                                     OR |         19        4.60        4.60
                                    Or. |          2        0.48        5.08
                                    Ore |          2        0.48        5.57
                                   Ore. |        382       92.49       98.06
                                  Oreg. |          1        0.24       98.31
                                 Oregon |          7        1.69      100.00
----------------------------------------+-----------------------------------
                                  Total |        413      100.00

***************************
PA

                      state_country_raw |      Freq.     Percent        Cum.
----------------------------------------+-----------------------------------
                                     PA |        164       12.77       12.77
                                    PA. |          7        0.55       13.32
                                     Pa |          4        0.31       13.63
                                    Pa. |      1,053       82.01       95.64
                                   Penn |          1        0.08       95.72
                                  Penn. |         42        3.27       98.99
                           Pennsylvania |         13        1.01      100.00
----------------------------------------+-----------------------------------
                                  Total |      1,284      100.00

***************************
RI

                      state_country_raw |      Freq.     Percent        Cum.
----------------------------------------+-----------------------------------
                                   R.I. |         47       92.16       92.16
                                     RI |          3        5.88       98.04
                           Rhode Island |          1        1.96      100.00
----------------------------------------+-----------------------------------
                                  Total |         51      100.00

***************************
SC

                      state_country_raw |      Freq.     Percent        Cum.
----------------------------------------+-----------------------------------
                                    S.C |          2        0.46        0.46
                                   S.C. |        407       94.00       94.46
                                     SC |         22        5.08       99.54
                         South Carolina |          2        0.46      100.00
----------------------------------------+-----------------------------------
                                  Total |        433      100.00

***************************
SD

                      state_country_raw |      Freq.     Percent        Cum.
----------------------------------------+-----------------------------------
                                   S.D. |         34       82.93       82.93
                                     SD |          2        4.88       87.80
                           South Dakota |          5       12.20      100.00
----------------------------------------+-----------------------------------
                                  Total |         41      100.00

***************************
TN

                      state_country_raw |      Freq.     Percent        Cum.
----------------------------------------+-----------------------------------
                                     TN |         30        5.62        5.62
                                   Tenn |          1        0.19        5.81
                                  Tenn. |        495       92.70       98.50
                              Tennessee |          8        1.50      100.00
----------------------------------------+-----------------------------------
                                  Total |        534      100.00

***************************
TX

                      state_country_raw |      Freq.     Percent        Cum.
----------------------------------------+-----------------------------------
                                     TX |        119        4.07        4.07
                                    TX. |          1        0.03        4.10
                                   Tex. |          2        0.07        4.17
                                  Texas |      2,800       95.69       99.86
                                 Texas. |          1        0.03       99.90
                                    Tx. |          3        0.10      100.00
----------------------------------------+-----------------------------------
                                  Total |      2,926      100.00

***************************
UT

                      state_country_raw |      Freq.     Percent        Cum.
----------------------------------------+-----------------------------------
                                     UT |          8        4.04        4.04
                                    Ut. |          1        0.51        4.55
                                   Utah |        189       95.45      100.00
----------------------------------------+-----------------------------------
                                  Total |        198      100.00

***************************
VA

                      state_country_raw |      Freq.     Percent        Cum.
----------------------------------------+-----------------------------------
                                     VA |         61        5.55        5.55
                                    VA. |          5        0.45        6.01
                                     Va |          8        0.73        6.73
                                    Va. |      1,008       91.72       98.45
                               Virginia |         17        1.55      100.00
----------------------------------------+-----------------------------------
                                  Total |      1,099      100.00

***************************
VT

                      state_country_raw |      Freq.     Percent        Cum.
----------------------------------------+-----------------------------------
                                     VT |          1        8.33        8.33
                                Vermont |          1        8.33       16.67
                                    Vt. |         10       83.33      100.00
----------------------------------------+-----------------------------------
                                  Total |         12      100.00

***************************
WA

                      state_country_raw |      Freq.     Percent        Cum.
----------------------------------------+-----------------------------------
                                     WA |         21        2.76        2.76
                                    Wa. |          2        0.26        3.02
                                  Wash. |        728       95.66       98.69
                             Washington |         10        1.31      100.00
----------------------------------------+-----------------------------------
                                  Total |        761      100.00

***************************
WI

                      state_country_raw |      Freq.     Percent        Cum.
----------------------------------------+-----------------------------------
                                     WI |         18        2.97        2.97
                                    Wis |          2        0.33        3.30
                                   Wis. |        530       87.46       90.76
                                  Wisc. |         37        6.11       96.86
                              Wisconsin |         19        3.14      100.00
----------------------------------------+-----------------------------------
                                  Total |        606      100.00

***************************
WV

                      state_country_raw |      Freq.     Percent        Cum.
----------------------------------------+-----------------------------------
                                 W. Va. |          6        5.22        5.22
                                   W.V. |          6        5.22       10.43
                                  W.Va. |        102       88.70       99.13
                                     WV |          1        0.87      100.00
----------------------------------------+-----------------------------------
                                  Total |        115      100.00

***************************
WY

                      state_country_raw |      Freq.     Percent        Cum.
----------------------------------------+-----------------------------------
                                     WY |          1        4.76        4.76
                                   Wyo. |         19       90.48       95.24
                                Wyoming |          1        4.76      100.00
----------------------------------------+-----------------------------------
                                  Total |         21      100.00

***************************

. restore

. 
. 
. // merge conference
. merge m:1 college using ${outdata}/schools, assert(3) nogen keepusing(conference)

    Result                           # of obs.
    -----------------------------------------
    not matched                             0
    matched                            35,781  
    -----------------------------------------

. 
. // cleanup
. la var name "Athlete Name (as scraped)"

. la var hometown "Athlete Hometown (as scraped)"

. la var prevschool "Athlete Previous School (as scraped)"

. la var sport "Sport (by gender)"

. la var college "College"

. la var city "City (if US)"

. la var state "State"

. la var nonUS "Hometown not matched to US state"

. 
. drop state_country_raw

. order nonUSmatch, last

. 
. // assert no complete duplicates (there is just one for some reason)
. bysort *: gen N = _N

. count if N > 1
  6

. local x = r(N)

. assert `x' == 6

. duplicates drop

Duplicates in terms of all variables

(3 observations deleted)

. drop N

. 
. // make sure cross-sport duplicates are truly multi-sport
. // i.e. make sure didn't scrape mens or womens roster twice and apply to other
. preserve

.         bysort name college hometown: gen N = _N

.         tab N

          N |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |     32,160       89.89       89.89
          2 |      3,612       10.10       99.98
          3 |          6        0.02      100.00
------------+-----------------------------------
      Total |     35,778      100.00

.         keep if N>1
(32,160 observations deleted)

.         gen gender = "M" if regexm(sport,"mens")
(35 missing values generated)

.         replace gender = "F" if regexm(sport,"womens")
(2,150 real changes made)

.         drop if missing(gender)
(35 observations deleted)

.         keep name college hometown sport gender

.         bysort name college hometown: egen maxF = max(gender=="F")

.         bysort name college hometown: egen minF = min(gender=="F")

.         assert maxF == minF

. restore

. 
. tab nonUSmatch

   Hometown |
not matched |
to US state |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |     31,673       88.53       88.53
          1 |      4,105       11.47      100.00
------------+-----------------------------------
      Total |     35,778      100.00

. count if !nonUSmatch
  31,673

. count if !nonUSmatch & !missing(city)
  31,672

. count if !nonUSmatch & !missing(city) & !missing(prevschool)
  29,726

. 
. export delimited using ${outdata}/rosters.csv, replace
file C:\Users\jrk5012/Documents/GitHub/ncaa_rosters/output/cleaned/rosters.csv saved

. save ${outdata}/rosters, replace
file ~/Documents/GitHub/ncaa_rosters/output/cleaned/rosters.dta saved

. 
. log close
      name:  <unnamed>
       log:  C:\Users\jrk5012/Documents/GitHub/ncaa_rosters/code/clean/clean.log
  log type:  text
 closed on:  18 Oct 2018, 18:50:44
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
